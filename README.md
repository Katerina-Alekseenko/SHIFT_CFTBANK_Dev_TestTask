# Описание модели

## Таблица CLIENTS
- **ID** – уникальный идентификатор (первичный ключ)
- **NAME** – ФИО клиента
- **PLACE_OF_BIRTH** – место рождения клиента
- **DATE_OF_BIRTH** – дата рождения клиента
- **ADDRESS** – адрес проживания клиента
- **PASSPORT** – паспортные данные клиента

## Таблица PRODUCTS
- **ID** – уникальный идентификатор (первичный ключ)
- **PRODUCT_TYPE_ID** – ссылка на тип продукта
- **NAME** – наименование продукта
- **CLIENT_REF** – ссылка на клиента
- **OPEN_DATE** – дата открытия продукта
- **CLOSE_DATE** – дата закрытия продукта

## Таблица PRODUCT_TYPE
- **ID** – уникальный идентификатор (первичный ключ)
- **NAME** – наименование типа продукта
- **BEGIN_DATE** – дата начала действия типа продукта
- **END_DATE** – дата окончания действия типа продукта
- **TARIF_REF** – ссылка на тариф

## Таблица ACCOUNTS
- **ID** – уникальный идентификатор (первичный ключ)
- **NAME** – наименование счета
- **SALDO** – остаток по счету
- **CLIENT_REF** – ссылка на клиента
- **OPEN_DATE** – дата открытия счета
- **CLOSE_DATE** – дата закрытия счета
- **PRODUCT_REF** – ссылка на продукт, в рамках которого открыт счет
- **ACC_NUM** – номер счета

## Таблица RECORDS
- **ID** – уникальный идентификатор (первичный ключ)
- **DT** – признак дебетования счета (1 – дебет, 0 – кредит)
- **ACC_REF** – ссылка на счет, по которому происходит движение
- **OPER_DATE** – дата операции
- **SUM** – сумма операции

## Таблица TARIFS
- **ID** – уникальный идентификатор (первичный ключ)
- **NAME** – наименование тарифа
- **COST** – сумма тарифа

# Описание процесса

Обслуживание клиента в банке начинается с заведения карточки клиента (таблица CLIENTS), далее клиент выражает завести тот или иной продукт в банке - КРЕДИТ, ДЕПОЗИТ, КАРТА (таблица PRODUCT_TYPE). После оформления документов в банке создается экземпляр продукта (таблица PRODUCTS), в рамках продукта открывается один или несколько счетов (таблица ACCOUNTS) с остатком равным 0.

Далее в случае, если оформлен продукт типа КРЕДИТ по счету продукта проходит дебетовая операция – банк выдает деньги клиенту (в таблице RECORDS появляется запись с полем DT = 1 и суммой зачисления, запись в таблице RECORDS влияет на поле SALDO таблицы ACCOUNTS). Если оформлен продукт ДЕПОЗИТ или КАРТА по счету клиента проходит кредитовая операция – клиент вносит средства на счета (в таблице RECORDS появляется запись с полем DT = 0 и суммой зачисления, запись в таблице RECORDS влияет на поле SALDO таблицы ACCOUNTS).

После чего клиент в случае, если ему открыт продукт типа КРЕДИТ, вносит средства на счет, погашая кредит, а если продукт типа ДЕПОЗИТ или КАРТА, может списывать средства со счета. После полного погашения продукта типа КРЕДИТ, выдача кредита может происходить снова, и клиент нужно опять осуществлять погашения. Если у клиента продукта типа ДЕПОЗИТ или КАРТА, клиент в любое время может внести средства.

# Задания

1. **Подготовьте DDL-скрипты создания объектов для приведённой модели: создание таблиц, первичных, уникальных, внешних ключей и т.д.**
2. **Заполните таблицы примерами из приложенного скрипта.**

    [СКАЧАТЬ СКРИПТ](https://drive.google.com/file/d/1jnxyq15o5SfdtrWBGC8EjXlBw1Id2Llf/view)

3. **Подготовьте скрипты заполнения таблиц тестовыми данными, достаточными для выполнения заданий ниже.**
4. **Сформируйте отчет, который содержит все счета, относящиеся к продуктам типа ДЕПОЗИТ, принадлежащих клиентам, у которых нет открытых продуктов типа КРЕДИТ.**
5. **Сформируйте выборку, который содержит средние движения по счетам в рамках одного произвольного дня, в разрезе типа продукта.**
6. **Сформируйте выборку, в который попадут клиенты, у которых были операции по счетам за прошедший месяц от текущей даты. Выведите клиента и сумму операций за день в разрезе даты.**
7. **В результате сбоя в базе данных разъехалась информация между остатками и операциями по счетам. Напишите нормализацию (процедуру выравнивающую данные), которая найдет такие счета и восстановит остатки по счету.**
8. **Сформируйте выборку, который содержит информацию о клиентах, которые полностью погасили кредит, но при этом не закрыли продукт и пользуются им дальше (по продукту есть операция новой выдачи кредита).**
9. **Закройте продукты (установите дату закрытия равную текущей) типа КРЕДИТ, у которых произошло полное погашение, но при этом не было повторной выдачи.**
10. **Закройте возможность открытия (установите дату окончания действия) для типов продуктов, по счетам продуктов которых, не было движений более одного месяца.**
11. **В модель данных добавьте сумму договора по продукту. Заполните поле для всех продуктов суммой максимальной дебетовой операции по счету для продукта типа КРЕДИТ, и суммой максимальной кредитовой операции по счету продукта для продукта типа ДЕПОЗИТ или КАРТА.**
